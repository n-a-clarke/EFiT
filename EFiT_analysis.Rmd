---
title: "EFiT Data Analysis"
author: "N. A. Clarke"
date: "06 March 2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, results = FALSE )
```

```{r load packages}
library(broom)
library(effectsize)
library(rstanarm)
library(bayestestR)
library(see)
library(insight)
library(bayesplot)
library(psych)
library(skimr)
library(cowplot)
library(ggdag)
library(readxl)
library(tidyverse)
library(bayesplot)
library(tidybayes)
```

```{r load in data file and tidy, warning=FALSE}
efit <- read_xlsx("EFiT_Main data set_5MARCH2020.xlsx") %>% 
  filter(!partNum == 3, !partNum ==30, !partNum == 79) #remove participants no.3 failed screen, no.30 had to withdraw, no.79 may have unreliable results 
#select varibles that aren't automatically processed with other scripts
efit <- efit %>% select(partNum:dualTask_wordsDiff, matrixReason, keepTrack)
efit <- efit %>% rename(participant = partNum)
#load files for automatically processed scripts: dual, nls, rif, rule, stroop
stroopJoin <- read_csv("processedStroop.csv")
ruleJoin <- read_csv("processedRule.csv") 
nlsJoin <- read_csv("processedNLS.csv")
dualJoin <- read_csv("processedDual.csv")
rifJoin <- read_csv("processedRIF.csv")
#join to main set by participant number
efit <- left_join(efit, ruleJoin, by = "participant")#join rule file
efit <- left_join(efit, stroopJoin, by = "participant")#join stroop file
efit <- left_join(efit, nlsJoin, by = "participant")#join nls file
efit <- left_join(efit, dualJoin, by = "participant")#join dual file
efit <- left_join(efit, rifJoin, by = "participant")#join rif file
```
#Data overview and descriptive statistics
```{r create new variables}
efit <- efit %>% 
  mutate(
    THI_cat = ifelse(
      THI >= 38 ,"bothersome tinnitus", ifelse(
        THI > 0 & THI <= 37, "tinnitus", "control"
      ))) #add a categorical variable with the groups split by THI scores

efit$THI_cat <- as.factor(efit$THI_cat) %>% ordered(levels = c("control", "tinnitus", "bothersome tinnitus"))#factorise tinnitus groups

#divide CRIq score by age
efit <- efit %>% mutate(CRIq_aged = CRIq/age)

#multiply DASS subscale scores by 2 and create DASS total variable
efit <- efit %>% 
  mutate(DASS_D = DASS_D*2,
         DASS_A = DASS_A*2,
         DASS_S = DASS_S*2,
         DASS_total = DASS_D+DASS_A+DASS_S)

#create new categorical variables for DASS_D subscale
efit <- efit %>% 
  mutate(
    DASS_D_cat = ifelse(
      DASS_D >= 28 ,"extremely severe", ifelse(
        DASS_D >= 21 & DASS_D <= 27, "severe", ifelse(
          DASS_D >= 14 & DASS_D <= 20, "moderate", ifelse(
          DASS_D >= 10 & DASS_D <= 13, "mild", "normal"
          )
        )
      ))) 

#create new categorical variables for DASS_A subscale
efit <- efit %>% 
  mutate(
    DASS_A_cat = ifelse(
      DASS_A >= 20 ,"extremely severe", ifelse(
        DASS_A >= 15 & DASS_A <= 19, "severe", ifelse(
          DASS_A >= 10 & DASS_A <= 14, "moderate", ifelse(
          DASS_A >= 8 & DASS_A <= 9, "mild", "normal"
          )
        )
      ))) 

#create new categorical variables for DASS_S subscale
efit <- efit %>% 
  mutate(
    DASS_S_cat = ifelse(
      DASS_S >= 34 ,"extremely severe", ifelse(
        DASS_S >= 26 & DASS_S <= 33, "severe", ifelse(
          DASS_S >= 19 & DASS_S <= 25, "moderate", ifelse(
          DASS_S >= 15 & DASS_S <= 18, "mild", "normal"
          )
        )
      ))) 
#factorise DASS subscale categories groups
efit$DASS_D_cat <- as.factor(efit$DASS_D_cat) %>% ordered(levels = c("normal", "mild", "moderate", "severe", "extremely severe"))

efit$DASS_A_cat <- as.factor(efit$DASS_A_cat) %>% ordered(levels = c("normal", "mild", "moderate", "severe", "extremely severe"))

efit$DASS_S_cat <- as.factor(efit$DASS_S_cat) %>% ordered(levels = c("normal", "mild", "moderate", "severe", "extremely severe"))

#create new RIF variable (proportion of correct respones and RIFdif (i.e. a measure of the RIF effect)
efit <- efit %>% 
mutate(pRIF_RpPlus = (Rp_plus/12) * 100, 
       pRIF_RpMinus = (Rp_minus/12) * 100,
       pRIF_Np = (Np/24) * 100,
       pRIF_total = ((Rp_plus + Rp_minus + Np)/48) * 100,
       RIF_Diff = pRIF_Np - pRIF_RpMinus)


```
##Group counts
```{r tinnitus group demographics}
#group_by tinnitus groups and count
groupCount <- efit %>% 
  group_by(THI_cat) %>% 
  summarise(group_count = n()) %>% 
  arrange(THI_cat)


#group_by tinnitus groups and median age self-report measures
groupAge <- efit %>% 
  group_by(THI_cat) %>% 
  summarise(median_age = median(age),
            age_sd = sd(age),
            mean_hearing_threshold = mean(hearThresh),
            mean_CFQ = mean(CFQ),
            mean_RRS = mean(RRS),
            mean_CRIq = mean(CRIq),
            mean_DASS_D = mean(DASS_D),
            mean_DASS_A = mean(DASS_A),
            mean_DASS_S = mean(DASS_S))

RIF <- efit %>% 
  group_by(THI_cat) %>% 
  summarise(Diff = mean(RIF_Diff),
            Plus = mean(pRIF_RpPlus),
            Minus = mean(pRIF_RpMinus),
            Np = mean(pRIF_Np))
```

`r knitr::kable(groupCount)`

##Group ages
`r knitr::kable(groupAge)`

##Histograms
```{r historgram age}
efit %>% ggplot(aes(x = age)) +
  geom_histogram() +
  facet_grid(. ~ THI_cat)
```
##DASS stacked bar charts
```{r depression stacked bar chart}
ggplot(data=efit, 
       aes(x = THI_cat, fill = fct_rev(DASS_D_cat))) +
  geom_bar(position = "fill") +
  scale_y_continuous(breaks = c(0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1)) +
  xlab("group") +
  ylab("proportion") +
  labs(fill = "depression categories") +
  ggtitle("proportion of depression severity in each group") +
  theme_cowplot() +
  theme(panel.grid.major.y = element_line(colour = "light gray", linetype = "dashed"))
```

```{r anxiety stacked bar chart}
ggplot(data=efit, 
       aes(x = THI_cat, fill = fct_rev(DASS_A_cat))) +
  geom_bar(position = "fill") +
  scale_y_continuous(breaks = c(0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1)) +
  xlab("group") +
  ylab("proportion") +
  labs(fill = "anxiety categories") +
  ggtitle("proportion of anxiety severity in each group") +
  theme_cowplot() +
  theme(panel.grid.major.y = element_line(colour = "light gray", linetype = "dashed"))
```

```{r stress stacked bar chart}
ggplot(data=efit, 
       aes(x = THI_cat, fill = fct_rev(DASS_S_cat))) +
  geom_bar(position = "fill") +
  scale_y_continuous(breaks = c(0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1)) +
  xlab("group") +
  ylab("proportion") +
  labs(fill = "stress categories") +
  ggtitle("proportion of stress severity in each group") +
  theme_cowplot() +
  theme(panel.grid.major.y = element_line(colour = "light gray", linetype = "dashed"))
```

```{r create variable for DASS subscale scores}
mod_DASS <- efit %>% 
  mutate(mod_DASS = ifelse(DASS_D > 13 |
                             DASS_A > 9 |
                             DASS_S > 18, 1, 0))

mod_DASS %>% select(DASS_D_cat, DASS_A_cat, DASS_S_cat, mod_DASS)
```

```{r moderate DASS scores stacked bar chart}
ggplot(data=mod_DASS, 
       aes(x = THI_cat, fill = as.factor(mod_DASS))) +
  geom_bar(position = "fill") +
  scale_y_continuous(breaks = c(0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1)) +
  xlab("group") +
  ylab("proportion") +
  labs(fill = "moderate dass") +
  ggtitle("proportion of moderate DASS severity in each group") +
  theme_cowplot() +
  theme(panel.grid.major.y = element_line(colour = "light gray", linetype = "dashed"))
```
#T-tests
```{r filtered data frames of different groups}
#filter by groups for statistical tests
controls <- efit %>% 
  filter(THI_cat == "none")
mild_tin <- efit %>% 
  filter(THI_cat == "mild")
modsev_tin <- efit %>% 
  filter(THI_cat == "modsev")
```
##Controls and Mild
###Number-letter sequencing
```{r t-test control-mild letter-number sequencing}
nls_control_mild_t.test <- t.test(controls$nls_correct, mild_tin$nls_correct, alternative = "greater",var.equal = F)#controls greater than mild

```

```{r tidy control-mild letter-number sequencing t-test to extract coefficients}
nls_control_mild_t.test_tidy <- tidy(nls_control_mild_t.test)

nls_control_mild_t.test_tidy <- nls_control_mild_t.test_tidy %>% 
  mutate(task = "number_letter_sequencing", groups = "control_mild")
```

###Keep-track
```{r t-test control-mild keep-track}
keeptrack_control_mild_t.test <- t.test(controls$keepTrack, mild_tin$keepTrack, alternative = "greater",var.equal = F)#controls greater than mild
```

```{r tidy control-mild keep-track t-test to extract coefficients}
keeptrack_control_mild_t.test_tidy <- tidy(keeptrack_control_mild_t.test)

keeptrack_control_mild_t.test_tidy <- keeptrack_control_mild_t.test_tidy %>% 
  mutate(task = "keeptrack", groups = "control_mild")
```

###Stroop
####Response time (incongruent)
```{r t-test control-mild stroop}
stroopRT_control_mild_t.test <- t.test(controls$stroop_incongruent, mild_tin$stroop_incongruent, alternative = "less",var.equal = F)#controls less than mild
```

```{r tidy control-mild stroop t-test to extract coefficients}
stroopRT_control_mild_t.test_tidy <- tidy(stroopRT_control_mild_t.test)

stroopRT_control_mild_t.test_tidy <- stroopRT_control_mild_t.test_tidy %>% 
  mutate(task = "stroop_rt", groups = "control_mild")
```

####Errors
```{r t-test control-mild stroop errors}
stroopErr_control_mild_t.test <- t.test(controls$stroop_errors, mild_tin$stroop_errors, alternative = "less",var.equal = F)#controls less than mild
```

```{r tidy control-mild stroop errors t-test to extract coefficients}
stroopErr_control_mild_t.test_tidy <- tidy(stroopErr_control_mild_t.test) 

stroopErr_control_mild_t.test_tidy <- stroopErr_control_mild_t.test_tidy %>% 
  mutate(task = "stroop_errors", groups = "control_mild")
```

###Retrieval-induced forgetting
```{r t-test control-mild retrieval-induced forgetting}
RIFdiff_control_mild_t.test <- t.test(controls$RIF_Diff, mild_tin$RIF_Diff, alternative = "greater",var.equal = F)#controls greater than mild
```

```{r tidy control-mild retrieval-induced forgetting t-test to extract coefficients}
RIFdiff_control_mild_t.test_tidy <- tidy(RIFdiff_control_mild_t.test) 

RIFdiff_control_mild_t.test_tidy <- RIFdiff_control_mild_t.test_tidy %>% 
  mutate(task = "RIF_diff", groups = "control_mild")
```

###Rule-switching
####Switch cost
```{r control-mild t-test switch cost}
switchcost_control_mild_t.test <- t.test(controls$switch_cost, mild_tin$switch_cost, alternative = "less",var.equal = F)#controls less than mild
```

```{r tidy control-mild switch cost t-test to extract coefficients}
switchcost_control_mild_t.test_tidy <- tidy(switchcost_control_mild_t.test) 

switchcost_control_mild_t.test_tidy <- switchcost_control_mild_t.test_tidy %>% 
  mutate(task = "switch_cost", groups = "control_mild")
```

####Errors
```{r control-mild t-test rule-switching errors}
switchErr_control_mild_t.test <- t.test(controls$rule_errors, mild_tin$rule_errors, alternative = "less",var.equal = F)#controls less than mild
```

```{r tidy control-mild rule-switching errors t-test to extract coefficients}
switchErr_control_mild_t.test_tidy <- tidy(switchErr_control_mild_t.test) 

switchErr_control_mild_t.test_tidy <- switchErr_control_mild_t.test_tidy %>% 
  mutate(task = "switch_errors", groups = "control_mild")
```

###Dual task
```{r t-test control-mild dual task}
dualtask_control_mild_t.test <- t.test(controls$dual_task_total, mild_tin$dual_task_total, alternative = "greater",var.equal = F)#controls greater than mild
```

```{r tidy control-mild dual task t-test to extract coefficients}
dualtask_control_mild_t.test_tidy <- tidy(dualtask_control_mild_t.test) 

dualtask_control_mild_t.test_tidy <- dualtask_control_mild_t.test_tidy %>% 
  mutate(task = "dual_task", groups = "control_mild")
```

###Matrix reasoning

```{r control-mild t-test matrix reasoning}
matrix_control_mild_t.test <- t.test(controls$matrixReason, mild_tin$matrixReason, alternative = "greater",var.equal = F)#controls greater than mild
```

```{r tidy control-mild matrix reasoning t-test to extract coefficients}
matrix_control_mild_t.test_tidy <- tidy(matrix_control_mild_t.test) 

matrix_control_mild_t.test_tidy <- matrix_control_mild_t.test_tidy %>% 
  mutate(task = "matrix_reasoning", groups = "control_mild")
```

##Controls and Modsev
###Number-letter sequencing
```{r t-test control-modsev letter-number sequencing}
nls_control_modsev_t.test <- t.test(controls$nls_correct, modsev_tin$nls_correct, alternative = "greater",var.equal = F)#controls greater than modsev

```

```{r tidy control-modsev letter-number sequencing t-test to extract coefficients}
nls_control_modsev_t.test_tidy <- tidy(nls_control_modsev_t.test)

nls_control_modsev_t.test_tidy <- nls_control_modsev_t.test_tidy %>% 
  mutate(task = "number_letter_sequencing", groups = "control_modsev")
```

###Keep-track
```{r t-test control-modsev keep-track}
keeptrack_control_modsev_t.test <- t.test(controls$keepTrack, modsev_tin$keepTrack, alternative = "greater",var.equal = F)#controls greater than modsev
```

```{r tidy control-modsev keep-track t-test to extract coefficients}
keeptrack_control_modsev_t.test_tidy <- tidy(keeptrack_control_modsev_t.test)

keeptrack_control_modsev_t.test_tidy <- keeptrack_control_modsev_t.test_tidy %>% 
  mutate(task = "keeptrack", groups = "control_modsev")
```

###Stroop
####Response time (incongruent)
```{r t-test control-modsev stroop}
stroopRT_control_modsev_t.test <- t.test(controls$stroop_incongruent, modsev_tin$stroop_incongruent, alternative = "less",var.equal = F)#controls less than modsev
```

```{r tidy control-modsev stroop t-test to extract coefficients}
stroopRT_control_modsev_t.test_tidy <- tidy(stroopRT_control_modsev_t.test)

stroopRT_control_modsev_t.test_tidy <- stroopRT_control_modsev_t.test_tidy %>% 
  mutate(task = "stroop_rt", groups = "control_modsev")
```

####Errors
```{r t-test control-modsev stroop errors}
stroopErr_control_modsev_t.test <- t.test(controls$stroop_errors, modsev_tin$stroop_errors, alternative = "less",var.equal = F)#controls less than modsev
```

```{r tidy control-modsev stroop errors t-test to extract coefficients}
stroopErr_control_modsev_t.test_tidy <- tidy(stroopErr_control_modsev_t.test) 

stroopErr_control_modsev_t.test_tidy <- stroopErr_control_modsev_t.test_tidy %>% 
  mutate(task = "stroop_errors", groups = "control_modsev")
```

###Retrieval-induced forgetting
```{r t-test control-modsev retrieval-induced forgetting}
RIFdiff_control_modsev_t.test <- t.test(controls$RIF_Diff, modsev_tin$RIF_Diff, alternative = "greater",var.equal = F)#controls greater than modsev
```

```{r tidy control-modsev retrieval-induced forgetting t-test to extract coefficients}
RIFdiff_control_modsev_t.test_tidy <- tidy(RIFdiff_control_modsev_t.test) 

RIFdiff_control_modsev_t.test_tidy <- RIFdiff_control_modsev_t.test_tidy %>% 
  mutate(task = "RIF_diff", groups = "control_modsev")
```

###Rule-switching
####Switch cost
```{r control-modsev t-test switch cost}
switchcost_control_modsev_t.test <- t.test(controls$switch_cost, modsev_tin$switch_cost, alternative = "less",var.equal = F)#controls less than modsev
```

```{r tidy control-modsev switch cost t-test to extract coefficients}
switchcost_control_modsev_t.test_tidy <- tidy(switchcost_control_modsev_t.test) 

switchcost_control_modsev_t.test_tidy <- switchcost_control_modsev_t.test_tidy %>% 
  mutate(task = "switch_cost", groups = "control_modsev")
```

####Errors
```{r control-modsev t-test rule-switching errors}
switchErr_control_modsev_t.test <- t.test(controls$rule_errors, modsev_tin$rule_errors, alternative = "less",var.equal = F)#controls less than modsev
```

```{r tidy control-modsev rule-switching errors t-test to extract coefficients}
switchErr_control_modsev_t.test_tidy <- tidy(switchErr_control_modsev_t.test) 

switchErr_control_modsev_t.test_tidy <- switchErr_control_modsev_t.test_tidy %>% 
  mutate(task = "switch_errors", groups = "control_modsev")
```

###Dual task
```{r t-test control-modsev dual task}
dualtask_control_modsev_t.test <- t.test(controls$dual_task_total, modsev_tin$dual_task_total, alternative = "greater",var.equal = F)#controls greater than modsev
```

```{r tidy control-modsev dual task t-test to extract coefficients}
dualtask_control_modsev_t.test_tidy <- tidy(dualtask_control_modsev_t.test) 

dualtask_control_modsev_t.test_tidy <- dualtask_control_modsev_t.test_tidy %>% 
  mutate(task = "dual_task", groups = "control_modsev")
```

###Matrix reasoning
```{r control-modsev t-test matrix reasoning}
matrix_control_modsev_t.test <- t.test(controls$matrixReason, modsev_tin$matrixReason, alternative = "greater",var.equal = F)#controls greater than modsev
```

```{r tidy control-modsev matrix reasoning t-test to extract coefficients}
matrix_control_modsev_t.test_tidy <- tidy(matrix_control_modsev_t.test) 

matrix_control_modsev_t.test_tidy <- matrix_control_modsev_t.test_tidy %>% 
  mutate(task = "matrix_reasoning", groups = "control_modsev")
```

##Mild and Modsev
###Number-letter sequencing
```{r t-test mild-modsev letter-number sequencing}
nls_mild_modsev_t.test <- t.test(mild_tin$nls_correct, modsev_tin$nls_correct, alternative = "greater",var.equal = F)#mild greater than modsev

```

```{r tidy mild-modsev letter-number sequencing t-test to extract coefficients}
nls_mild_modsev_t.test_tidy <- tidy(nls_mild_modsev_t.test)

nls_mild_modsev_t.test_tidy <- nls_mild_modsev_t.test_tidy %>% 
  mutate(task = "number_letter_sequencing", groups = "mild_modsev")
```

###Keep-track
```{r t-test mild-modsev keep-track}
keeptrack_mild_modsev_t.test <- t.test(mild_tin$keepTrack, modsev_tin$keepTrack, alternative = "greater",var.equal = F)#milds greater than modsev
```

```{r tidy mild-modsev keep-track t-test to extract coefficients}
keeptrack_mild_modsev_t.test_tidy <- tidy(keeptrack_mild_modsev_t.test)

keeptrack_mild_modsev_t.test_tidy <- keeptrack_mild_modsev_t.test_tidy %>% 
  mutate(task = "keeptrack", groups = "mild_modsev")
```

###Stroop
####Response time (incongruent)
```{r t-test mild-modsev stroop}
stroopRT_mild_modsev_t.test <- t.test(mild_tin$stroop_incongruent, modsev_tin$stroop_incongruent, alternative = "less",var.equal = F)#milds less than modsev
```

```{r tidy mild-modsev stroop t-test to extract coefficients}
stroopRT_mild_modsev_t.test_tidy <- tidy(stroopRT_mild_modsev_t.test)

stroopRT_mild_modsev_t.test_tidy <- stroopRT_mild_modsev_t.test_tidy %>% 
  mutate(task = "stroop_rt", groups = "mild_modsev")
```

####Errors
```{r t-test mild-modsev stroop errors}
stroopErr_mild_modsev_t.test <- t.test(mild_tin$stroop_errors, modsev_tin$stroop_errors, alternative = "less",var.equal = F)#milds less than modsev
```

```{r tidy mild-modsev stroop errors t-test to extract coefficients}
stroopErr_mild_modsev_t.test_tidy <- tidy(stroopErr_mild_modsev_t.test) 

stroopErr_mild_modsev_t.test_tidy <- stroopErr_mild_modsev_t.test_tidy %>% 
  mutate(task = "stroop_errors", groups = "mild_modsev")
```

###Retrieval-induced forgetting
```{r t-test mild-modsev retrieval-induced forgetting}
RIFdiff_mild_modsev_t.test <- t.test(mild_tin$RIF_Diff, modsev_tin$RIF_Diff, alternative = "greater",var.equal = F)#milds greater than modsev
```

```{r tidy mild-modsev retrieval-induced forgetting t-test to extract coefficients}
RIFdiff_mild_modsev_t.test_tidy <- tidy(RIFdiff_mild_modsev_t.test) 

RIFdiff_mild_modsev_t.test_tidy <- RIFdiff_mild_modsev_t.test_tidy %>% 
  mutate(task = "RIF_diff", groups = "mild_modsev")
```

###Rule-switching
####Switch cost
```{r mild-modsev t-test switch cost}
switchcost_mild_modsev_t.test <- t.test(mild_tin$switch_cost, modsev_tin$switch_cost, alternative = "less",var.equal = F)#milds less than modsev
```

```{r tidy mild-modsev switch cost t-test to extract coefficients}
switchcost_mild_modsev_t.test_tidy <- tidy(switchcost_mild_modsev_t.test) 

switchcost_mild_modsev_t.test_tidy <- switchcost_mild_modsev_t.test_tidy %>% 
  mutate(task = "switch_cost", groups = "mild_modsev")
```

####Errors
```{r mild-modsev t-test rule-switching errors}
switchErr_mild_modsev_t.test <- t.test(mild_tin$rule_errors, modsev_tin$rule_errors, alternative = "less",var.equal = F)#milds less than modsev
```

```{r tidy mild-modsev rule-switching errors t-test to extract coefficients}
switchErr_mild_modsev_t.test_tidy <- tidy(switchErr_mild_modsev_t.test) 

switchErr_mild_modsev_t.test_tidy <- switchErr_mild_modsev_t.test_tidy %>% 
  mutate(task = "switch_errors", groups = "mild_modsev")
```

###Dual task
```{r t-test mild-modsev dual task}
dualtask_mild_modsev_t.test <- t.test(mild_tin$dual_task_total, modsev_tin$dual_task_total, alternative = "greater",var.equal = F)#milds greater than modsev
```

```{r tidy mild-modsev dual task t-test to extract coefficients}
dualtask_mild_modsev_t.test_tidy <- tidy(dualtask_mild_modsev_t.test) 

dualtask_mild_modsev_t.test_tidy <- dualtask_mild_modsev_t.test_tidy %>% 
  mutate(task = "dual_task", groups = "mild_modsev")
```

###Matrix reasoning
```{r mild-modsev t-test matrix reasoning}
matrix_mild_modsev_t.test <- t.test(mild_tin$matrixReason, modsev_tin$matrixReason, alternative = "greater",var.equal = F)#milds greater than modsev
```

```{r tidy mild-modsev matrix reasoning t-test to extract coefficients}
matrix_mild_modsev_t.test_tidy <- tidy(matrix_mild_modsev_t.test) 

matrix_mild_modsev_t.test_tidy <- matrix_mild_modsev_t.test_tidy %>% 
  mutate(task = "matrix_reasoning", groups = "mild_modsev")
```

##Table of t-test results
###Controls and Mild
```{r bind together tidy t.test results of control and milds}
t.test_table_control_mild <- bind_rows(nls_control_mild_t.test_tidy,
        keeptrack_control_mild_t.test_tidy,
        stroopRT_control_mild_t.test_tidy,
        stroopErr_control_mild_t.test_tidy,
        RIFdiff_control_mild_t.test_tidy,
        switchcost_control_mild_t.test_tidy,
        switchErr_control_mild_t.test_tidy,
        dualtask_control_mild_t.test_tidy,
        matrix_control_mild_t.test_tidy)

#add task names to table and filter out tasks that are statistically significant at Bayes Factor agreement level
t.test_table_control_mild %>% 
  mutate(task = c("nls", "keeptrack", "stroopRT",
                  "stroopErr", "RIFdiff", "switch_cost",
                  "switch_error", "dual_task", "matrix_reason")) %>% 
  select(task, p.value) %>% 
  filter(p.value < 0.01)
```
###Controls and Modsev
```{r bind together tidy t.test results of control and modsev}
t.test_table_control_modsev <- bind_rows(nls_control_modsev_t.test_tidy,
        keeptrack_control_modsev_t.test_tidy,
        stroopRT_control_modsev_t.test_tidy,
        stroopErr_control_modsev_t.test_tidy,
        RIFdiff_control_modsev_t.test_tidy,
        switchcost_control_modsev_t.test_tidy,
        switchErr_control_modsev_t.test_tidy,
        dualtask_control_modsev_t.test_tidy,
        matrix_control_modsev_t.test_tidy)

#add task names to table and filter out tasks that are statistically significant at Bayes Factor agreement level
t.test_table_control_modsev %>% 
  mutate(task = c("nls", "keeptrack", "stroopRT",
                  "stroopErr", "RIFdiff", "switch_cost",
                  "switch_error", "dual_task", "matrix_reason")) %>% 
  select(task, p.value) %>% 
  filter(p.value < 0.01)
```    
###Mild and Modsev
```{r bind together tidy t.test results of mild and modsev}
t.test_table_mild_modsev <- bind_rows(nls_mild_modsev_t.test_tidy,
        keeptrack_mild_modsev_t.test_tidy,
        stroopRT_mild_modsev_t.test_tidy,
        stroopErr_mild_modsev_t.test_tidy,
        RIFdiff_mild_modsev_t.test_tidy,
        switchcost_mild_modsev_t.test_tidy,
        switchErr_mild_modsev_t.test_tidy,
        dualtask_mild_modsev_t.test_tidy,
        matrix_mild_modsev_t.test_tidy)
``` 
#Cohen's d
```{r calculate cohens d for all tasks}
#effect size for RIF effect
rif_cd_control_modsev <- cohens_d(controls$RIF_Diff, modsev_tin$RIF_Diff)#controls vs modsev
rif_cd_control_mild <- cohens_d(controls$RIF_Diff, mild_tin$RIF_Diff)#controls vs mild
rif_cd_mild_modsev <- cohens_d(mild_tin$RIF_Diff, modsev_tin$RIF_Diff) #mild vs modsev

#effect size for NLS scores
nls_cd_control_modsev <- cohens_d(controls$nls_correct, modsev_tin$nls_correct)#controls vs modsev
nls_cd_control_mild <- cohens_d(controls$nls_correct, mild_tin$nls_correct)#controls vs mild
nls_cd_mild_modsev <- cohens_d(mild_tin$nls_correct, modsev_tin$nls_correct)#mild vs modsev

#effect size for keep track scores
keep_cd_control_modsev <- cohens_d(controls$keepTrack, modsev_tin$keepTrack)#controls vs modsev
keep_cd_control_mild <- cohens_d(controls$keepTrack, mild_tin$keepTrack)#controls vs mild
keep_cd_mild_modsev <- cohens_d(mild_tin$keepTrack, modsev_tin$keepTrack)#mild vs modsev

#effect size for matrix reasoning scores
matrix_cd_control_modsev <- cohens_d(controls$matrixReason, modsev_tin$matrixReason)#controls vs modsev
matrix_cd_control_mild <- cohens_d(controls$matrixReason, mild_tin$matrixReason)#controls vs mild
matrix_cd_mild_modsev <- cohens_d(mild_tin$matrixReason, modsev_tin$matrixReason)#mild vs modsev

#effect size for stroop response times
stroopRT_cd_control_modsev <- cohens_d(controls$stroop_incongruent, modsev_tin$stroop_incongruent)#controls vs modsev
stroopRT_cd_control_mild <- cohens_d(controls$stroop_incongruent, mild_tin$stroop_incongruent)#controls vs mild
stroopRT_cd_mild_modsev <- cohens_d(mild_tin$stroop_incongruent, modsev_tin$stroop_incongruent)#mild vs modsev

#effect size for stroop error counts
stroopERR_cd_control_modsev <- cohens_d(controls$stroop_errors, modsev_tin$stroop_errors)#controls vs modsev
stroopERR_cd_control_mild <- cohens_d(controls$stroop_errors, mild_tin$stroop_errors)#controls vs mild
stroopERR_cd_mild_modsev <- cohens_d(mild_tin$stroop_errors, modsev_tin$stroop_errors)#mild vs modsev

#effect size for switch cost
switchCostRT_cd_control_modsev <- cohens_d(controls$switch_cost, modsev_tin$switch_cost)#controls vs modsev
switchCostRT_cd_control_mild <- cohens_d(controls$switch_cost, mild_tin$switch_cost)#controls vs mild
switchCostRT_cd_mild_modsev <- cohens_d(mild_tin$switch_cost, modsev_tin$switch_cost)#mild vs modsev

#effect size for rule switch errors
switchErr_cd_control_modsev <- cohens_d(controls$rule_errors, modsev_tin$rule_errors)#controls vs modsev
switchErr_cd_control_mild <- cohens_d(controls$rule_errors, mild_tin$rule_errors)#controls vs mild
switchErr_cd_mild_modsev <- cohens_d(mild_tin$rule_errors, modsev_tin$rule_errors)#mild vs modsev

#effect size for dual task numbers score
dual_cd_control_modsev <- cohens_d(controls$dual_task_total, modsev_tin$dual_task_total)#controls vs modsev
dual_cd_control_mild <- cohens_d(controls$dual_task_total, mild_tin$dual_task_total)#controls vs mild
dual_cd_mild_modsev <- cohens_d(mild_tin$dual_task_total, modsev_tin$dual_task_total)#mild vs modsev
```

```{r cohens d confidence interval control-mild}
#cohens_d confidence intervals for controls vs mild
rif_cd_control_mild_CI <- d.ci(rif_cd_control_mild, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for RIF
nls_cd_control_mild_CI <- d.ci(nls_cd_control_mild, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for nls
keep_cd_control_mild_CI <- d.ci(keep_cd_control_mild, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for keep track
matrix_cd_control_mild_CI <- d.ci(matrix_cd_control_mild, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for matrix reasoning
stroopRT_cd_control_mild_CI <- d.ci(stroopRT_cd_control_mild , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for Stroop RT
stroopERR_cd_control_mild_CI <- d.ci(stroopERR_cd_control_mild , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for Stroop errors
switchCostRT_cd_control_mild_CI <- d.ci(switchCostRT_cd_control_mild , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for switch cost
switchErr_cd_control_mild_CI <- d.ci(switchErr_cd_control_mild , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for switch errors
dual_cd_control_mildCI <- d.ci(dual_cd_control_mild , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for dual task
```

```{r cohens d confidence intervals control-modsev}
#cohens_d confidence intervals for controls vs modsev
rif_cd_control_modsev_CI <- d.ci(rif_cd_control_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for RIF

nls_cd_control_modsev_CI <- d.ci(nls_cd_control_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for nls

keep_cd_control_modsev_CI <- d.ci(keep_cd_control_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for keep track

matrix_cd_control_modsev_CI <- d.ci(matrix_cd_control_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for matrix reasoning

stroopRT_cd_control_modsev_CI <- d.ci(stroopRT_cd_control_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for Stroop RT
stroopERR_cd_control_modsev_CI <- d.ci(stroopERR_cd_control_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for Stroop errors
switchCostRT_cd_control_modsev_CI <- d.ci(switchCostRT_cd_control_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for switch cost
switchErr_cd_control_modsev_CI <- d.ci(switchErr_cd_control_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for switch errors
dual_cd_control_modsevCI <- d.ci(dual_cd_control_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for dual task
```

```{r cohens d confidence intervals mild-modsev}
#cohens_d confidence intervals for controls vs modsev
rif_cd_mild_modsev_CI <- d.ci(rif_cd_mild_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for RIF
nls_cd_mild_modsev_CI <- d.ci(nls_cd_mild_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for nls
keep_cd_mild_modsev_CI <- d.ci(keep_cd_mild_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for keep track
matrix_cd_mild_modsev_CI <- d.ci(matrix_cd_mild_modsev, n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for matrix reasoning
stroopRT_cd_mild_modsev_CI <- d.ci(stroopRT_cd_mild_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for Stroop RT
stroopERR_cd_mild_modsev_CI <- d.ci(stroopERR_cd_mild_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for Stroop errors
switchCostRT_cd_mild_modsev_CI <- d.ci(switchCostRT_cd_mild_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for switch cost
switchErr_cd_mild_modsev_CI <- d.ci(switchErr_cd_mild_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for switch errors
dual_cd_mild_modsevCI <- d.ci(dual_cd_mild_modsev , n1=groupCount$group_count[1], n2=groupCount$group_count[3])#confidence interval for dual task
```

```{r create table of cohens d and confidence intervals for control-mild}
#create dataframe of cohens_d scores for control vs mild
control_mild_cd <- data.frame(
  c("Retrieval-induced forgetting", 
    "Number letter sequencing", 
    "Keep track", 
    "Matrix reasoning",
    "Stroop-RT", 
    "Stroop-errors", 
    "Switch cost", 
    "Switch errors", 
    "Dual task"),
  c(rif_cd_control_mild, 
    nls_cd_control_mild, 
    keep_cd_control_mild, 
    matrix_cd_control_mild, 
    stroopRT_cd_control_mild, 
    stroopERR_cd_control_mild, 
    switchCostRT_cd_control_mild,
    switchErr_cd_control_mild, 
    dual_cd_control_mild),
  c(rif_cd_control_mild_CI[1], 
    nls_cd_control_mild_CI[1], 
    keep_cd_control_mild_CI[1], 
    matrix_cd_control_mild_CI[1], 
    stroopRT_cd_control_mild_CI[1], 
    stroopERR_cd_control_mild_CI[1], 
    switchCostRT_cd_control_mild_CI[1],
    switchErr_cd_control_mild_CI[1], 
    dual_cd_control_mildCI[1]),
  c(rif_cd_control_mild_CI[3], 
    nls_cd_control_mild_CI[3], 
    keep_cd_control_mild_CI[3], 
    matrix_cd_control_mild_CI[3], 
    stroopRT_cd_control_mild_CI[3], 
    stroopERR_cd_control_mild_CI[3], 
    switchCostRT_cd_control_mild_CI[3],
    switchErr_cd_control_mild_CI[3], 
    dual_cd_control_mildCI[3]),
  c(rep("control vs mild", 9))
)
colnames(control_mild_cd) <- c("task", "cohens_d", "CI_lower","CI_upper", "group")
```

```{r create table of cohens d and confidence intervals for controls-modsev}
#create dataframe of cohens_d scores for control vs modsev
control_modsev_cd <- data.frame(
  c("Retrieval-induced forgetting", 
    "Number letter sequencing", 
    "Keep track", 
    "Matrix reasoning",
    "Stroop-RT", 
    "Stroop-errors", 
    "Switch cost", 
    "Switch errors", 
    "Dual task"),
  c(rif_cd_control_modsev, 
    nls_cd_control_modsev, 
    keep_cd_control_modsev, 
    matrix_cd_control_modsev, 
    stroopRT_cd_control_modsev, 
    stroopERR_cd_control_modsev, 
    switchCostRT_cd_control_modsev,
    switchErr_cd_control_modsev, 
    dual_cd_control_modsev),
  c(rif_cd_control_modsev_CI[1], 
    nls_cd_control_modsev_CI[1], 
    keep_cd_control_modsev_CI[1], 
    matrix_cd_control_modsev_CI[1], 
    stroopRT_cd_control_modsev_CI[1], 
    stroopERR_cd_control_modsev_CI[1], 
    switchCostRT_cd_control_modsev_CI[1],
    switchErr_cd_control_modsev_CI[1], 
    dual_cd_control_modsevCI[1]),
  c(rif_cd_control_modsev_CI[3], 
    nls_cd_control_modsev_CI[3], 
    keep_cd_control_modsev_CI[3], 
    matrix_cd_control_modsev_CI[3], 
    stroopRT_cd_control_modsev_CI[3], 
    stroopERR_cd_control_modsev_CI[3], 
    switchCostRT_cd_control_modsev_CI[3],
    switchErr_cd_control_modsev_CI[3], 
    dual_cd_control_modsevCI[3]),
  c(rep("control vs modsev", 9))
  )
colnames(control_modsev_cd) <- c("task", "cohens_d", "CI_lower","CI_upper", "group")
```

```{r create table of cohens d and confidence intervals for mild-modsev}
#create dataframe of cohens_d scores for mild vs modsev
mild_modsev_cd <- data.frame(
  c("Retrieval-induced forgetting", 
    "Number letter sequencing", 
    "Keep track", 
    "Matrix reasoning",
    "Stroop-RT", 
    "Stroop-errors", 
    "Switch cost", 
    "Switch errors", 
    "Dual task"),
  c(rif_cd_mild_modsev, 
    nls_cd_mild_modsev, 
    keep_cd_mild_modsev, 
    matrix_cd_mild_modsev, 
    stroopRT_cd_mild_modsev, 
    stroopERR_cd_mild_modsev, 
    switchCostRT_cd_mild_modsev,
    switchErr_cd_mild_modsev, 
    dual_cd_mild_modsev),
  c(rif_cd_mild_modsev_CI[1], 
    nls_cd_mild_modsev_CI[1], 
    keep_cd_mild_modsev_CI[1], 
    matrix_cd_mild_modsev_CI[1], 
    stroopRT_cd_mild_modsev_CI[1], 
    stroopERR_cd_mild_modsev_CI[1], 
    switchCostRT_cd_mild_modsev_CI[1],
    switchErr_cd_mild_modsev_CI[1], 
    dual_cd_mild_modsevCI[1]),
  c(rif_cd_mild_modsev_CI[3], 
    nls_cd_mild_modsev_CI[3], 
    keep_cd_mild_modsev_CI[3], 
    matrix_cd_mild_modsev_CI[3], 
    stroopRT_cd_mild_modsev_CI[3], 
    stroopERR_cd_mild_modsev_CI[3], 
    switchCostRT_cd_mild_modsev_CI[3],
    switchErr_cd_mild_modsev_CI[3], 
    dual_cd_mild_modsevCI[3]),
  c(rep("mild vs modsev", 9))
  )
colnames(mild_modsev_cd) <- c("task", "cohens_d", "CI_lower","CI_upper", "group")
```

```{r join all cohens d and confidence interval tables}
#join all cohens d and ci tables together
all_groups_cohens_ci <- bind_rows(control_mild_cd, control_modsev_cd, mild_modsev_cd)

all_groups_cohens_ci$group <- as.factor(all_groups_cohens_ci$group)
```

```{r filtered table for control-mild and control-moderate cohens d plot}
control_mild_control_modsev_cohensd_ci <- all_groups_cohens_ci %>% 
  filter(group != "mild vs modsev")#filter all group cohens d table for control-mild and control-modsev

control_mild_control_modsev_cohensd_ci <- control_mild_control_modsev_cohensd_ci %>% arrange(cohens_d)#arrange for easier transform

control_mild_control_modsev_cohensd_ci[1:12,2:4] <- control_mild_control_modsev_cohensd_ci[1:12,2:4]*-1#transofrm direction of negative effects for easier interpretation - now all effect sizes represent

#round confidence intervals and lower/upper bounds to 1 dececimal place
control_mild_control_modsev_cohensd_ci$cohens_d <- round(control_mild_control_modsev_cohensd_ci$cohens_d,1)
control_mild_control_modsev_cohensd_ci$CI_lower <- round(control_mild_control_modsev_cohensd_ci$CI_lower,2)
control_mild_control_modsev_cohensd_ci$CI_upper <- round(control_mild_control_modsev_cohensd_ci$CI_upper,2)

```

```{r cohens d plot of control-mild and control-modsev}
#plot of cohens_d for control vs modsev and control vs mild for each task
control_mild_control_modsev_cohensd_ci %>% 
  arrange(desc(task)) %>% 
ggplot(aes(x = task, y = cohens_d, colour = group)) +
  geom_point(alpha = 0.9, shape = 15, size = 3, position = position_dodge(width=0.5)) +
  geom_errorbar(alpha = 0.5, aes(ymin=CI_lower, ymax=CI_upper), position=position_dodge(width=0.5)) +
  geom_hline(yintercept = 0, linetype = "longdash") +
  coord_flip() +
  scale_color_brewer(palette = "Set1") +
  theme_cowplot(12)
```

#Bayesian t-tests
```{r bayesian t.test control-mild}
#Controls vs mild - drop modsev observations for bayesian t-test
bayes_control_mild <- efit %>% 
  filter(THI_cat != "modsev") %>% 
  droplevels()

#bayesian ttest for rule switch task - control vs mild
control_mild_switch_cost_BF <- BayesFactor::ttestBF(formula = switch_cost ~ THI_cat, data = bayes_control_mild)
BF_control_mild_switchCost <- describe_posterior(control_mild_switch_cost_BF)

#bayesian ttest for rule switch error - control vs mild
control_mod_mild_switch_error_BF <- BayesFactor::ttestBF(formula = rule_errors ~ THI_cat, data = bayes_control_mild)
BF_control_mild_switchError <- describe_posterior(control_mod_mild_switch_error_BF)

#bayesian ttest for stroop response time - control vs mild
control_mild_stroop_rt_BF <- BayesFactor::ttestBF(formula = stroop_incongruent ~ THI_cat, data = bayes_control_mild)
BF_control_mild_stroopRT <- describe_posterior(control_mild_stroop_rt_BF)

#bayesian ttest for stroop error count - control vs mild
control_mild_stroop_error_BF <- BayesFactor::ttestBF(formula = stroop_errors ~ THI_cat, data = bayes_control_mild)
BF_control_mild_stroopError <- describe_posterior(control_mild_stroop_error_BF)

#bayesian ttest for number letter sequencing - control vs mild
control_mild_nls_BF <- BayesFactor::ttestBF(formula = nls_correct ~ THI_cat, data = bayes_control_mild)
BF_control_mild_nls <- describe_posterior(control_mild_nls_BF)

#bayesian ttest for keep track task - control vs mild
control_mild_keep_BF <- BayesFactor::ttestBF(formula = keepTrack ~ THI_cat, data = bayes_control_mild)
BF_control_mild_keep <- describe_posterior(control_mild_keep_BF)

#bayesian ttest for RIF - control vs mild
control_mild_RIF_BF <- BayesFactor::ttestBF(formula = RIF_Diff ~ THI_cat, data = bayes_control_mild)
BF_control_mild_RIF <- describe_posterior(control_mild_RIF_BF)

#bayesian ttest for matrix reasoning - control vs mild
control_mild_matrix_BF <- BayesFactor::ttestBF(formula = matrixReason ~ THI_cat, data = bayes_control_mild)
BF_control_mild_matrix <- describe_posterior(control_mild_matrix_BF)

#bayesian ttest for dual task - control vs mild
control_mild_dual_BF <- BayesFactor::ttestBF(formula = dual_task_total ~ THI_cat, data = bayes_control_mild)
BF_control_mild_dual <- describe_posterior(control_mild_dual_BF)

#bayesian ttest for CFQ - control vs mild
control_mild_CFQ_BF <- BayesFactor::ttestBF(formula = CFQ ~ THI_cat, data = bayes_control_mild)
BF_control_mild_CFQ <- describe_posterior(control_mild_CFQ_BF)

#bayesian ttest for RRS - control vs mild
control_mild_RRS_BF <- BayesFactor::ttestBF(formula = RRS ~ THI_cat, data = bayes_control_mild)
BF_control_mild_RRS<- describe_posterior(control_mild_RRS_BF)

#bayesian ttest for CRIq_aged - control vs mild
control_mild_CRIq_aged_BF <- BayesFactor::ttestBF(formula = CRIq_aged ~ THI_cat, data = bayes_control_mild)
BF_control_mild_CRIq_aged <- describe_posterior(control_mild_CRIq_aged_BF)

#bayesian ttest for depression - control vs mild
control_mild_depression_BF <- BayesFactor::ttestBF(formula = CRIq_aged ~ THI_cat, data = bayes_control_mild)
BF_control_mild_depression <- describe_posterior(control_mild_depression_BF)

#bayesian ttest for anxiety - control vs mild
control_mild_anxiety_BF <- BayesFactor::ttestBF(formula = DASS_A ~ THI_cat, data = bayes_control_mild)
BF_control_mild_anxiety <- describe_posterior(control_mild_anxiety_BF)

#bayesian ttest for stress - control vs mild
control_mild_stress_BF <- BayesFactor::ttestBF(formula = DASS_S ~ THI_cat, data = bayes_control_mild)
BF_control_mild_stress <- describe_posterior(control_mild_stress_BF)
```

```{r bayesian t.test control-modsev}
#Controls vs modsev - drop mild observations for bayesian t-test
bayes_control_modsev <- efit %>% 
  filter(THI_cat != "mild") %>% 
  droplevels()

#bayesian ttest for switch cost - control vs modsev
control_modsev_switch_cost_BF <- BayesFactor::ttestBF(formula = switch_cost ~ THI_cat, data = bayes_control_modsev)  
BF_control_modsev_switchCost <- describe_posterior(control_modsev_switch_cost_BF)

#bayesian ttest for rule switch error - control vs modsev
control_modsev_switch_error_BF <- BayesFactor::ttestBF(formula = rule_errors ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_switchError <- describe_posterior(control_modsev_switch_error_BF)

#bayesian ttest for stroop response time - control vs modsev
control_modsev_stroop_rt_BF <- BayesFactor::ttestBF(formula = stroop_incongruent ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_stroopRT <- describe_posterior(control_modsev_stroop_rt_BF)

#bayesian ttest for stroop error count - control vs modsev
control_modsev_stroop_error_BF <- BayesFactor::ttestBF(formula = stroop_errors ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_stroopError <- describe_posterior(control_modsev_stroop_error_BF)

#bayesian ttest for number letter sequencing - control vs modsev
control_modsev_nls_BF <- BayesFactor::ttestBF(formula = nls_correct ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_nls <- describe_posterior(control_modsev_nls_BF)

#bayesian ttest for keep track task - control vs modsev
control_modsev_keep_BF <- BayesFactor::ttestBF(formula = keepTrack ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_keep <- describe_posterior(control_modsev_keep_BF)

#bayesian ttest for RIF - control vs modsev
control_modsev_RIF_BF <- BayesFactor::ttestBF(formula = RIF_Diff ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_RIF <- describe_posterior(control_modsev_RIF_BF)

#bayesian ttest for matrix reasoning - control vs modsev
control_modsev_matrix_BF <- BayesFactor::ttestBF(formula = matrixReason ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_matrix <- describe_posterior(control_modsev_matrix_BF)

#bayesian ttest for dual task - control vs modsev
control_modsev_dual_BF <- BayesFactor::ttestBF(formula = dual_task_total ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_dual <- describe_posterior(control_modsev_dual_BF)

#bayesian ttest for CFQ - control vs modsev
control_modsev_CFQ_BF <- BayesFactor::ttestBF(formula = CFQ ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_CFQ <- describe_posterior(control_modsev_CFQ_BF)

#bayesian ttest for RRS - control vs modsev
control_modsev_RRS_BF <- BayesFactor::ttestBF(formula = RRS ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_RRS <- describe_posterior(control_modsev_RRS_BF)

#bayesian ttest for CRIq_aged - control vs modsev
control_modsev_CRIq_aged_BF <- BayesFactor::ttestBF(formula = CRIq_aged ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_CRIq_aged <- describe_posterior(control_modsev_CRIq_aged_BF)

#bayesian ttest for depression - control vs modsev
control_modsev_depression_BF <- BayesFactor::ttestBF(formula = CRIq_aged ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_depression <- describe_posterior(control_modsev_depression_BF)

#bayesian ttest for anxiety - control vs modsev
control_modsev_anxiety_BF <- BayesFactor::ttestBF(formula = DASS_A ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_anxiety <- describe_posterior(control_modsev_anxiety_BF)

#bayesian ttest for stress - control vs modsev
control_modsev_stress_BF <- BayesFactor::ttestBF(formula = DASS_S ~ THI_cat, data = bayes_control_modsev)
BF_control_modsev_stress <- describe_posterior(control_modsev_stress_BF)
```

```{r table of bayes factors for control-mild}
#create table of bayes factors for control vs mild
control_mild_BF <- data.frame(
  c("Retrieval-induced forgetting", 
    "Number letter sequencing", 
    "Keep track", 
    "Matrix reasoning",
    "Stroop-RT", 
    "Stroop-errors", 
    "Switch cost", 
    "Switch errors", 
    "Dual task",
    "CFQ",
    "RRS",
    "CRIq_aged",
    "Depression",
    "Anxiety",
    "Stress"),
  c(BF_control_mild_RIF$BF, 
    BF_control_mild_nls$BF, 
    BF_control_mild_keep$BF,
    BF_control_mild_matrix$BF,
    BF_control_mild_stroopRT$BF,
    BF_control_mild_stroopError$BF,
    BF_control_mild_switchCost$BF,
    BF_control_mild_switchError$BF,
    BF_control_mild_dual$BF,
    BF_control_mild_CFQ$BF,
    BF_control_mild_RRS$BF,
    BF_control_mild_CRIq_aged$BF,
    BF_control_mild_depression$BF,
    BF_control_mild_anxiety$BF,
    BF_control_mild_stress$BF)
)
colnames(control_mild_BF) <- c("name", "bayes_factor")
control_mild_BF$bayes_factor <- signif(control_mild_BF$bayes_factor, 2)

control_mild_BF <- control_mild_BF %>% arrange(desc(bayes_factor))
```
`r knitr::kable(control_mild_BF)`
```{r table of bayes factors for control-modsev}
#bayes factor for control vs modsev
control_modsev_BF <- data.frame(
  c("Retrieval-induced forgetting", 
    "Number letter sequencing", 
    "Keep track", 
    "Matrix reasoning",
    "Stroop-RT", 
    "Stroop-errors", 
    "Switch cost", 
    "Switch errors", 
    "Dual task",
    "CFQ",
    "RRS",
    "CRIq_aged",
    "Depression",
    "Anxiety",
    "Stress"),
  c(BF_control_modsev_RIF$BF, 
    BF_control_modsev_nls$BF, 
    BF_control_modsev_keep$BF,
    BF_control_modsev_matrix$BF,
    BF_control_modsev_stroopRT$BF,
    BF_control_modsev_stroopError$BF,
    BF_control_modsev_switchCost$BF,
    BF_control_modsev_switchError$BF,
    BF_control_modsev_dual$BF,
    BF_control_modsev_CFQ$BF,
    BF_control_modsev_RRS$BF,
    BF_control_modsev_CRIq_aged$BF,
    BF_control_modsev_depression$BF,
    BF_control_modsev_anxiety$BF,
    BF_control_modsev_stress$BF)
)
colnames(control_modsev_BF) <- c("name", "bayes_factor")
control_modsev_BF$bayes_factor <- signif(control_modsev_BF$bayes_factor, 2)

control_modsev_BF <- control_modsev_BF %>% arrange(desc(bayes_factor))
```
`r knitr::kable(control_modsev_BF)`
#Linear regressions
##Data preparation
```{r linear regression data preparation}
efit$THI_cat <- as.integer(efit$THI_cat)

efit$THI_cat <- as.factor(efit$THI_cat)

efit <- efit %>% 
  mutate(nls_correct_scaled = scale(nls_correct),
         RIF_Diff_scaled = scale(RIF_Diff),
         keepTrack_scaled = scale(keepTrack),
         stroop_incongruent_scaled = scale(stroop_incongruent),
         stroop_errors_scaled = scale(stroop_errors),
         switch_cost_scaled = scale(switch_cost),
         rule_errors_scaled = scale(rule_errors),
         dualTask_wordsDiff_scaled = scale(dualTask_wordsDiff),
         matrixReason_scaled = scale(matrixReason),
         age_scaled = scale(age),
         hearThresh_scaled = scale(hearThresh),
         DASS_A_scaled = scale(DASS_A),
         DASS_D_scaled = scale(DASS_D),
         DASS_S_scaled = scale(DASS_S)
         )




```

##Number-letter sequencing
```{r nls THI groups lm}
nls_lm_tincats <- lm(formula = nls_correct ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_nls_lm_tincats <- tidy(nls_lm_tincats)

#create formula for calculating standardised partial regression coefficent to check against the scaled model: sp = b * (sd(IV)/sd(DV))
#stand_partial <- tidy_nls_lm_tincats$estimate[2]* sd(efit$age)/sd(efit$nls_correct) 

#standardised version of the model
nls_lm_tincats_scaled <- lm(formula = nls_correct_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_nls_lm_tincats_scaled <- tidy(nls_lm_tincats_scaled)

ranked_nls_lm_tincats_scaled <- tidy_nls_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(estimate),
         task = "nls_correct")
```

##Keep track
```{r keeptrack THI groups lm}
keepTrack_lm_tincats <- lm(formula = keepTrack ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_keepTrack_lm_tincats <- tidy(keepTrack_lm_tincats)

keepTrack_lm_tincats_scaled <- lm(formula = keepTrack_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_keepTrack_lm_tincats_scaled <- tidy(keepTrack_lm_tincats_scaled)

ranked_keepTrack_lm_tincats_scaled <- tidy_keepTrack_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(estimate),
         task = "keep_track_correct")
```
##Stroop
###RT
```{r stroop incong_rt THI groups lm}
stroopRT_lm_tincats <- lm(formula = stroop_incongruent ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_stroopRT_lm_tincats <- tidy(stroopRT_lm_tincats)

stroopRT_lm_tincats_scaled <- lm(formula = stroop_incongruent_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_stroopRT_lm_tincats_scaled <- tidy(stroopRT_lm_tincats_scaled)

ranked_stroopRT_lm_tincats_scaled <- tidy_stroopRT_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(-estimate),
         task = "stroop_incongruent_rt")
```
###Errors
```{r stroop errors THI groups lm}
stroopErr_lm_tincats <- lm(formula = stroop_errors ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_stroopErr_lm_tincats <- tidy(stroopErr_lm_tincats)

stroopErr_lm_tincats_scaled <- lm(formula = stroop_errors_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_stroopErr_lm_tincats_scaled <- tidy(stroopErr_lm_tincats_scaled)

ranked_stroopErr_lm_tincats_scaled <- tidy_stroopErr_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(-estimate),
         task = "stroop_errors")
```
##RIF
```{r RIF difference THI groups lm}
RIF_diff_lm_tincats <- lm(formula = RIF_Diff ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_RIF_diff_lm_tincats <- tidy(RIF_diff_lm_tincats)

RIF_diff_lm_tincats_scaled <- lm(formula = RIF_Diff_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_RIF_diff_lm_tincats_scaled <- tidy(RIF_diff_lm_tincats_scaled)

ranked_RIF_diff_lm_tincats_scaled  <- tidy_RIF_diff_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(estimate),
         task = "RIF_difference")
```
##Rule-switch
###RT
```{r rule switchcost THI groups lm}
ruleSwitchCost_lm_tincats <- lm(formula = switch_cost ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_ruleSwitchCost_lm_tincats <- tidy(ruleSwitchCost_lm_tincats)

ruleSwitchCost_lm_tincats_scaled <- lm(formula = switch_cost_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_ruleSwitchCost_lm_tincats_scaled <- tidy(ruleSwitchCost_lm_tincats_scaled)

ranked_ruleSwitchCost_lm_tincats_scaled  <- tidy_ruleSwitchCost_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(-estimate),
         task = "rule_switch_cost")
```
###Errors
```{r rule errors THI groups lm}
ruleErr_lm_tincats <- lm(formula = rule_errors ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_ruleErr_lm_tincats <- tidy(ruleErr_lm_tincats)

ruleErr_lm_tincats_scaled <- lm(formula = rule_errors_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_ruleErr_lm_tincats_scaled <- tidy(ruleErr_lm_tincats_scaled)

ranked_ruleErr_lm_tincats_scaled   <- tidy_ruleErr_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(-estimate),
         task = "rule_switch_errors")
```
##Dual task
```{r dual task THI groups lm}
dualTask_lm_tincats <- lm(formula = dualTask_wordsDiff ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_dualTask_lm_tincats <- tidy(dualTask_lm_tincats)

dualTask_lm_tincats_scaled <- lm(formula = dualTask_wordsDiff_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_dualTask_lm_tincats_scaled <- tidy(dualTask_lm_tincats_scaled)

ranked_dualTask_lm_tincats_scaled <- tidy_dualTask_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(estimate),
         task = "dual_task_words_diff")
```
##Matrix reasoning
```{r matrix reasoning THI groups lm}
matrixReason_lm_tincats <- lm(formula = matrixReason ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit)

tidy_matrixReason_lm_tincats <- tidy(matrixReason_lm_tincats)

matrixReason_lm_tincats_scaled <- lm(formula = matrixReason_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit)

tidy_matrixReason_lm_tincats_scaled <- tidy(matrixReason_lm_tincats_scaled)

ranked_matrixReason_lm_tincats_scaled <- tidy_matrixReason_lm_tincats_scaled %>% 
  filter(term != "(Intercept)") %>% 
  mutate(partial_beta_rank = rank(estimate),
         task = "matrix_reasoning")
```

```{r bind tables of all ranked lm results}
all_ranked_lm_tincats_scaled <- rbind(
  ranked_nls_lm_tincats_scaled,
  ranked_dualTask_lm_tincats_scaled,
  ranked_keepTrack_lm_tincats_scaled,
  ranked_matrixReason_lm_tincats_scaled,
  ranked_RIF_diff_lm_tincats_scaled,
  ranked_ruleErr_lm_tincats_scaled,
  ranked_ruleSwitchCost_lm_tincats_scaled,
  ranked_stroopErr_lm_tincats_scaled,
  ranked_stroopRT_lm_tincats_scaled
) 

all_ranked_lm_tincats_scaled$term <- all_ranked_lm_tincats_scaled$term %>% 
  str_replace("THI_cat2", "tinnitus") %>% 
  str_replace("THI_cat3", "bothersome_tinnitus")

```

```{r find ranks of bothersome tinnitus partial beta}
bothersome_tinnitus_rank <- all_ranked_lm_tincats_scaled %>%
  filter(term == "bothersome_tinnitus") %>% 
  select(task, partial_beta_rank, estimate)

bothersome_tinnitus_rank$estimate <- round(bothersome_tinnitus_rank$estimate, digits = 2)

bothersome_tinnitus_rank <- bothersome_tinnitus_rank %>% 
  arrange(partial_beta_rank, estimate)

all_ranked_lm_tincats_scaled %>% 
  filter(task == "rule_switch_cost"|
         task == "rule_switch_errors"|
         task == "stroop_incongruent_rt"|
           task == "dual_task_words_diff") %>% 
  filter(partial_beta_rank == 1 |
           partial_beta_rank == 2) %>% 
  select(task,term, partial_beta_rank, estimate) %>% 
  arrange(partial_beta_rank, estimate)
```

#Retrieval-induced forgetting analysis
```{r means of all practise variables by THI group}
RIF_mean_table <- efit %>% 
  group_by(THI_cat) %>% 
  summarise(pRp_plus_mean = round(mean(pRIF_RpPlus)),
            pRp_minus_mean = round(mean(pRIF_RpMinus)),
            pNp_mean = round(mean(pRIF_Np)),
            pRIF_total_mean = round(mean(pRIF_total)),
            RIF_Diff_mean = round(mean(RIF_Diff)))

RIF_mean_table$THI_cat <- as.character(RIF_mean_table$THI_cat)

RIF_mean_table$THI_cat <- RIF_mean_table$THI_cat %>% 
  str_replace("1", "control") %>% 
  str_replace("2", "tinnitus") %>% 
  str_replace("3", "bothersome_tinnitus")
```
`r knitr::kable(RIF_mean_table)`

#BAYESIAN LINEAR MODELS
##Number-letter sequencing
```{r rstanarm nls THI groups lm}
bayes_nls_lm_tincats <- stan_glm(formula = nls_correct ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_nls_lm_tincats)#priors used for this model

summary_bayes_nls_lm_tincats <- summary(bayes_nls_lm_tincats) 


#standardised version of the model
bayes_nls_lm_tincats_scaled <- stan_glm(formula = nls_correct_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_nls_lm_tincats_scaled <- as.data.frame(summary(bayes_nls_lm_tincats_scaled))

summary_bayes_nls_lm_tincats_scaled <- summary_bayes_nls_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_nls_lm_tincats_scaled <- summary_bayes_nls_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(mean),
         task = "nls_correct") %>% 
  select(task,IV,mean, partial_beta_rank)

rank_bayes_nls_lm_tincats_scaled$mean <- round(rank_bayes_nls_lm_tincats_scaled$mean, digits = 2)

nls_scaled_posterior_samples <- spread_draws(bayes_nls_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

nls_partial_beta_prob_tinnitus <- mean(nls_scaled_posterior_samples$THI_cat2 < 0) %>% round(digits = 2)

nls_partial_beta_prob_bothersome_tinnitus <- mean(nls_scaled_posterior_samples$THI_cat3 < 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3

#mean(posterior_samples2$THI_cat3 < 0)#tells us the model's probability that draws for this paramater are < 0
```

##Keep track
```{r rstanarm keep track THI groups lm}
bayes_keepTrack_lm_tincats <- stan_glm(formula = keepTrack ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_keepTrack_lm_tincats)#priors used for this model

summary_bayes_keepTrack_lm_tincats <- summary(bayes_keepTrack_lm_tincats) 


#standardised version of the model
bayes_keepTrack_lm_tincats_scaled <- stan_glm(formula = keepTrack_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_keepTrack_lm_tincats_scaled <- as.data.frame(summary(bayes_keepTrack_lm_tincats_scaled))

summary_bayes_keepTrack_lm_tincats_scaled <- summary_bayes_keepTrack_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_keepTrack_lm_tincats_scaled <- summary_bayes_keepTrack_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(mean),
         task = "keep_track_correct") %>% 
  select(task, IV,mean, partial_beta_rank)

rank_bayes_keepTrack_lm_tincats_scaled$mean <- round(rank_bayes_keepTrack_lm_tincats_scaled$mean, digits = 2)

keepTrack_scaled_posterior_samples <- spread_draws(bayes_keepTrack_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

keepTrack_partial_beta_prob_tinnitus <- mean(keepTrack_scaled_posterior_samples$THI_cat2 < 0) %>% round(digits = 2)

keepTrack_partial_beta_prob_bothersome_tinnitus <- mean(keepTrack_scaled_posterior_samples$THI_cat3 < 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

##Stroop
###RT
```{r rstanarm stroop_incong rt THI groups lm}
bayes_stroopRT_lm_tincats <- stan_glm(formula = stroop_incongruent ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_stroopRT_lm_tincats)#priors used for this model

summary_bayes_stroopRT_lm_tincats <- summary(bayes_stroopRT_lm_tincats) 


#standardised version of the model
bayes_stroopRT_lm_tincats_scaled <- stan_glm(formula = stroop_incongruent_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_stroopRT_lm_tincats_scaled <- as.data.frame(summary(bayes_stroopRT_lm_tincats_scaled))

summary_bayes_stroopRT_lm_tincats_scaled <- summary_bayes_stroopRT_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_stroopRT_lm_tincats_scaled <- summary_bayes_stroopRT_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(-mean),
         task = "stroop_rt") %>% 
  select(task,IV,mean, partial_beta_rank)#USE -mean() for rt and errors

rank_bayes_stroopRT_lm_tincats_scaled$mean <- round(rank_bayes_stroopRT_lm_tincats_scaled$mean, digits = 2)

stroopRT_scaled_posterior_samples <- spread_draws(bayes_stroopRT_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

stroopRT_partial_beta_prob_tinnitus <- mean(stroopRT_scaled_posterior_samples$THI_cat2 > 0) %>% round(digits = 2)

stroopRT_partial_beta_prob_bothersome_tinnitus <- mean(stroopRT_scaled_posterior_samples$THI_cat3 > 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

###Errors
```{r rstanarm stroop error THI groups lm}
bayes_stroopErr_lm_tincats <- stan_glm(formula = stroop_errors ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit,seed = 12345)#fit standard model

prior_summary(bayes_stroopErr_lm_tincats)#priors used for this model

summary_bayes_stroopErr_lm_tincats <- summary(bayes_stroopErr_lm_tincats) 


#standardised version of the model
bayes_stroopErr_lm_tincats_scaled <- stan_glm(formula = stroop_errors_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_stroopErr_lm_tincats_scaled <- as.data.frame(summary(bayes_stroopErr_lm_tincats_scaled))

summary_bayes_stroopErr_lm_tincats_scaled <- summary_bayes_stroopErr_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_stroopErr_lm_tincats_scaled <- summary_bayes_stroopErr_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(-mean),
         task = "stroop_errors") %>% 
  select(task,IV,mean, partial_beta_rank)#USE -mean() for rt and errors

rank_bayes_stroopErr_lm_tincats_scaled$mean <- round(rank_bayes_stroopErr_lm_tincats_scaled$mean, digits = 2)

stroopErr_scaled_posterior_samples <- spread_draws(bayes_stroopErr_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

stroopErr_partial_beta_prob_tinnitus <- mean(stroopErr_scaled_posterior_samples$THI_cat2 > 0) %>% round(digits = 2)

stroopErr_partial_beta_prob_bothersome_tinnitus <- mean(stroopErr_scaled_posterior_samples$THI_cat3 > 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

##RIF effect
```{r rstanarm RIF_Diff error THI groups lm}
bayes_RIF_Diff_lm_tincats <- stan_glm(formula = RIF_Diff ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_RIF_Diff_lm_tincats)#priors used for this model

summary_bayes_RIF_Diff_lm_tincats <- summary(bayes_RIF_Diff_lm_tincats) 


#standardised version of the model
bayes_RIF_Diff_lm_tincats_scaled <- stan_glm(formula = RIF_Diff_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit,seed = 12345)

summary_bayes_RIF_Diff_lm_tincats_scaled <- as.data.frame(summary(bayes_RIF_Diff_lm_tincats_scaled))

summary_bayes_RIF_Diff_lm_tincats_scaled <- summary_bayes_RIF_Diff_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_RIF_Diff_lm_tincats_scaled <- summary_bayes_RIF_Diff_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(mean),
         task = "RIF_effect") %>% 
  select(task, IV,mean, partial_beta_rank)

rank_bayes_RIF_Diff_lm_tincats_scaled$mean <- round(rank_bayes_RIF_Diff_lm_tincats_scaled$mean, digits = 2)

RIF_Diff_scaled_posterior_samples <- spread_draws(bayes_RIF_Diff_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

RIF_Diff_partial_beta_prob_tinnitus <- mean(RIF_Diff_scaled_posterior_samples$THI_cat2 < 0) %>% round(digits = 2)

RIF_Diff_partial_beta_prob_bothersome_tinnitus <- mean(RIF_Diff_scaled_posterior_samples$THI_cat3 < 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

##Rule switch
###RT
```{r rstanarm switch_cost rt THI groups lm}
bayes_switchCost_lm_tincats <- stan_glm(formula = switch_cost ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_switchCost_lm_tincats)#priors used for this model

summary_bayes_switchCost_lm_tincats <- summary(bayes_switchCost_lm_tincats) 


#standardised version of the model
bayes_switchCost_lm_tincats_scaled <- stan_glm(formula = switch_cost_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_switchCost_lm_tincats_scaled <- as.data.frame(summary(bayes_switchCost_lm_tincats_scaled))

summary_bayes_switchCost_lm_tincats_scaled <- summary_bayes_switchCost_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_switchCost_lm_tincats_scaled <- summary_bayes_switchCost_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(-mean),
         task = "switch_cost") %>% 
  select(task, IV,mean, partial_beta_rank)#USE -mean() for rt and errors

rank_bayes_switchCost_lm_tincats_scaled$mean <- round(rank_bayes_switchCost_lm_tincats_scaled$mean, digits = 2)

switchCost_scaled_posterior_samples <- spread_draws(bayes_switchCost_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

switchCost_partial_beta_prob_tinnitus <- mean(switchCost_scaled_posterior_samples$THI_cat2 > 0) %>% round(digits = 2)

switchCost_partial_beta_prob_bothersome_tinnitus <- mean(switchCost_scaled_posterior_samples$THI_cat3 > 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

###Errors
```{r rstanarm rule errors THI groups lm}
bayes_ruleErr_lm_tincats <- stan_glm(formula = rule_errors ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_ruleErr_lm_tincats)#priors used for this model

summary_bayes_ruleErr_lm_tincats <- summary(bayes_ruleErr_lm_tincats) 


#standardised version of the model
bayes_ruleErr_lm_tincats_scaled <- stan_glm(formula = rule_errors_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_ruleErr_lm_tincats_scaled <- as.data.frame(summary(bayes_ruleErr_lm_tincats_scaled))

summary_bayes_ruleErr_lm_tincats_scaled <- summary_bayes_ruleErr_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_ruleErr_lm_tincats_scaled <- summary_bayes_ruleErr_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(-mean),
         task = "rule_errors") %>% 
  select(task, IV,mean, partial_beta_rank)#USE -mean() for rt and errors

rank_bayes_ruleErr_lm_tincats_scaled$mean <- round(rank_bayes_ruleErr_lm_tincats_scaled$mean, digits = 2)

ruleErr_scaled_posterior_samples <- spread_draws(bayes_ruleErr_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

ruleErr_partial_beta_prob_tinnitus <- mean(ruleErr_scaled_posterior_samples$THI_cat2 > 0) %>% round(digits = 2)

ruleErr_partial_beta_prob_bothersome_tinnitus <- mean(ruleErr_scaled_posterior_samples$THI_cat3 > 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

##Dual task
```{r rstanarm Dualtask_Diff error THI groups lm}
bayes_dualTask_lm_tincats <- stan_glm(formula = dualTask_wordsDiff ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_dualTask_lm_tincats)#priors used for this model

summary_bayes_dualTask_lm_tincats <- summary(bayes_dualTask_lm_tincats) 


#standardised version of the model
bayes_dualTask_lm_tincats_scaled <- stan_glm(formula = dualTask_wordsDiff_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit, seed = 12345)

summary_bayes_dualTask_lm_tincats_scaled <- as.data.frame(summary(bayes_dualTask_lm_tincats_scaled))

summary_bayes_dualTask_lm_tincats_scaled <- summary_bayes_dualTask_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_dualTask_lm_tincats_scaled <- summary_bayes_dualTask_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(mean),
         task = "dual_task_words_diff") %>% 
  select(task, IV,mean, partial_beta_rank)

rank_bayes_dualTask_lm_tincats_scaled$mean <- round(rank_bayes_dualTask_lm_tincats_scaled$mean, digits = 2)

dualTask_scaled_posterior_samples <- spread_draws(bayes_dualTask_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

dualTask_partial_beta_prob_tinnitus <- mean(dualTask_scaled_posterior_samples$THI_cat2 < 0) %>% round(digits = 2)

dualTask_partial_beta_prob_bothersome_tinnitus <- mean(dualTask_scaled_posterior_samples$THI_cat3 < 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

##Matrix reasoning
```{r rstanarm matrix reason THI groups lm}
bayes_matrixReason_lm_tincats <- stan_glm(formula = matrixReason ~ THI_cat + age + hearThresh + DASS_A + DASS_D + DASS_S, data = efit, seed = 12345)#fit standard model

prior_summary(bayes_matrixReason_lm_tincats)#priors used for this model

summary_bayes_matrixReason_lm_tincats <- summary(bayes_matrixReason_lm_tincats) 


#standardised version of the model
bayes_matrixReason_lm_tincats_scaled <- stan_glm(formula = matrixReason_scaled ~ THI_cat + age_scaled + hearThresh_scaled + DASS_A_scaled + DASS_D_scaled + DASS_S_scaled, data = efit,seed = 12345)

summary_bayes_matrixReason_lm_tincats_scaled <- as.data.frame(summary(bayes_matrixReason_lm_tincats_scaled))

summary_bayes_matrixReason_lm_tincats_scaled <- summary_bayes_matrixReason_lm_tincats_scaled %>%
  rownames_to_column(var = "IV")

rank_bayes_matrixReason_lm_tincats_scaled <- summary_bayes_matrixReason_lm_tincats_scaled %>% 
  filter(IV == "THI_cat2"|
         IV == "THI_cat3"|
         IV == "age_scaled"|
         IV == "hearThresh_scaled"|
         IV == "DASS_A_scaled"|
         IV == "DASS_D_scaled"|
         IV == "DASS_S_scaled") %>% 
  mutate(partial_beta_rank = rank(mean),
         task = "matrix_reasoning") %>% 
  select(task, IV,mean, partial_beta_rank)

rank_bayes_matrixReason_lm_tincats_scaled$mean <- round(rank_bayes_matrixReason_lm_tincats_scaled$mean, digits = 2)

matrixReason_scaled_posterior_samples <- spread_draws(bayes_matrixReason_lm_tincats_scaled, c(THI_cat3, THI_cat2), seed = 123)

matrixReason_partial_beta_prob_tinnitus <- mean(matrixReason_scaled_posterior_samples$THI_cat2 < 0) %>% round(digits = 2)

matrixReason_partial_beta_prob_bothersome_tinnitus <- mean(matrixReason_scaled_posterior_samples$THI_cat3 < 0) %>% round(digits = 2)

#posterior_samples <- as.matrix(bayes_nls_lm_tincats, pars = "THI_cat3")#extract posterior draws for THI_cat3
```

```{r bind tables of all ranked bayes lm results}
all_bayes_ranked_lm_tincats_scaled <- rbind(
  rank_bayes_nls_lm_tincats_scaled,
  rank_bayes_dualTask_lm_tincats_scaled,
  rank_bayes_keepTrack_lm_tincats_scaled,
 rank_bayes_matrixReason_lm_tincats_scaled,
  rank_bayes_RIF_Diff_lm_tincats_scaled,
  rank_bayes_ruleErr_lm_tincats_scaled,
  rank_bayes_switchCost_lm_tincats_scaled,
  rank_bayes_stroopErr_lm_tincats_scaled,
  rank_bayes_stroopRT_lm_tincats_scaled
) %>% rename(estimate = mean)

all_bayes_ranked_lm_tincats_scaled$IV <- all_bayes_ranked_lm_tincats_scaled$IV %>% 
  str_replace("THI_cat2", "tinnitus") %>% 
  str_replace("THI_cat3", "bothersome_tinnitus")

```

```{r find bayes ranks of bothersome tinnitus partial beta}
bayes_bothersome_tinnitus_rank <- all_bayes_ranked_lm_tincats_scaled %>%
  filter(IV == "bothersome_tinnitus") %>% 
  select(task, partial_beta_rank, estimate) %>% 
  arrange(partial_beta_rank, estimate)

bayes_bothersome_tinnitus_rank <- bayes_bothersome_tinnitus_rank %>% 
  mutate(non_zero_prob = c(matrixReason_partial_beta_prob_bothersome_tinnitus,
           keepTrack_partial_beta_prob_bothersome_tinnitus,
           RIF_Diff_partial_beta_prob_bothersome_tinnitus,
           stroopErr_partial_beta_prob_bothersome_tinnitus,
           nls_partial_beta_prob_bothersome_tinnitus,
           dualTask_partial_beta_prob_bothersome_tinnitus,
           switchCost_partial_beta_prob_bothersome_tinnitus,ruleErr_partial_beta_prob_bothersome_tinnitus,
           stroopRT_partial_beta_prob_bothersome_tinnitus))

```
`r knitr::kable(bothersome_tinnitus_rank)`

`r knitr::kable(bayes_bothersome_tinnitus_rank)`
```{r causal model}
efit_causal <- efit %>%
  filter(THI_cat != "none")

m1 <- stan_glm(THI_cat ~ nls_correct+ switch_cost + stroop_incongruent +matrixReason + age + DASS_D + DASS_A + DASS_S,
               family = "binomial",
               data = efit_causal,
               seed = 123)

plot(m1, "areas", prob = 0.95, prob_outer = 1)
```

